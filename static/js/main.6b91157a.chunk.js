(this["webpackJsonppeat-bomb"]=this["webpackJsonppeat-bomb"]||[]).push([[0],{102:function(e,t,n){},147:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),l=n(74),i=n(33),s=n(64),u=n(39),m={value:0},d=Object(i.combineReducers)({count:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INCREMENT_COUNTER":return Object(u.a)({},e,{value:e.value+1});case"DECREMENT_COUNTER":return Object(u.a)({},e,{value:e.value-1});default:return e}}}),h=Object(i.createStore)(d,Object(s.devToolsEnhancer)({})),p=(n(102),n(50)),f=n(27),g=function(){var e=Object(f.f)();return r.a.createElement(a.Fragment,null,r.a.createElement("h1",null,"About"),r.a.createElement("p",null,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptas possimus doloribus error cumque autem asperiores, ullam deserunt quidem omnis doloremque itaque eius eaque sint facilis unde tenetur reiciendis aliquam soluta?"),r.a.createElement("button",{type:"button",className:"btn",onClick:function(){return e.push("/")}},"Go back"))},b=n(30),w=n.n(b),E=n(48),v=n(31),j=n(75),O=n(196),k=n(198),x=n(201),y=n(202),S=n(203),C=n(206),N=n(193),L=n(205),W=n(150),q=n(207),F=n(209),I=n(208),R=n(148),A=n(192),T=n(190),z=n(204),D=n(191),P=n(210),_=Object(T.a)((function(e){var t=e.maxWidth,n=e.height,a=e.parentWidth>t?e.maxWidth:e.parentWidth;console.log("> width",a);var o,c=a,l=Object(z.a)({domain:[0,10],range:[0,c],clamp:!0}),i="rgba(64, 64, 64, 0.6)",s=(o=e.points).reduce((function(e,t){return e+t}),0)/o.length;return r.a.createElement("svg",{width:1.5*a,height:n},r.a.createElement("rect",{width:a,height:n,fill:"rgba(64, 64, 64, 0)"}),r.a.createElement(R.a,null,e.points.map((function(e,t){var a=l(e),o=.3*n;return r.a.createElement(D.a,{key:"point-".concat(t),className:"dot",cx:a,cy:o,r:3,fill:"rgba(246, 196, 49, 0.5)"})}))),r.a.createElement(P.a,{verticalAnchor:"start",style:{fontSize:11,fill:"rgba(64, 64, 64, 0.6)"}},"n = ".concat(e.points.length)),r.a.createElement(A.a,{from:{x:l(s),y:0},to:{x:l(s),y:.15*n},stroke:"rgba(64, 64, 64, 0.4",strokeWidth:1.5,label:"avg = ".concat(s.toFixed(2)),labelFill:"rgba(64, 64, 64, 0.6)",labelStroke:"none",labelDx:6,labelDy:10}),r.a.createElement(I.a,{top:.6*n,scale:l,tickFormat:function(e){return e},stroke:i,tickStroke:i,tickLength:4,hideZero:!1,tickLabelProps:function(e,t){return{fill:i,fontSize:11,textAnchor:"middle"}}}))})),J=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)},option:{fontSize:15,"& > span":{marginRight:10,fontSize:18}}}})),M=function(e){return["review #","bottle review #"].some((function(t){return e.data.title.toLowerCase().startsWith(t)}))},U=function(e){return["review #","review ","bottle review #"].some((function(t){return e.data.title.toLowerCase().includes(t)}))},V=function(e){console.log("normaliseScore",e);var t=null;if(-1!==e.search(/^[0-9]{1,}$/g))return t=Number(e),Number(t<=10?t:t/10);if(-1!==e.search(/^[0-9.]{1,}\/[0-9]{3}$/g)){t=e.split("/");var n=Number(t[0]);return Number(n<=10?n:n/10)}return null},$=function(e,t){return e.data.title.substring(e.data.title.toLowerCase().indexOf(t.toLowerCase()))};function B(e,t){return null!==t?[].concat(Object(j.a)(e),[t]):[]}var G=function(){var e=J(),t=r.a.useState(!1),n=Object(v.a)(t,2),o=n[0],c=n[1],l=r.a.useState([]),i=Object(v.a)(l,2),s=i[0],m=i[1],d=r.a.useState(null),h=Object(v.a)(d,2),p=h[0],f=h[1],g=r.a.useState(null),b=Object(v.a)(g,2),j=b[0],N=b[1],I=r.a.useReducer(B,[]),R=Object(v.a)(I,2),A=R[0],T=R[1],z=Object(F.a)(p,500),D=Object(v.a)(z,1)[0],P=o&&0===s.length,G=Object(a.useCallback)((function(e,t){Object(E.a)(w.a.mark((function n(){var a,r,o,c,l;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://www.reddit.com/comments/".concat(t,"/.json"));case 2:return a=n.sent,n.next=5,a.json();case 5:if(r=n.sent,console.log("thread",r),null===(o=r[1].data.children[0].data.body.match(/[0-9.]{1,}\/[0-9]{1,3}/g))&&null!==(o=r[1].data.children[0].data.body.match(/Rating: [0-9.]{1,}/g))&&(o=o.map((function(e){return e.replace("Rating: ","")}))),null===o){n.next=17;break}c=o[o.length-1],l=V(c),console.log(e.data.title,"Score",l),console.log("https://www.reddit.com".concat(e.data.permalink)),null!==l&&T(l),n.next=20;break;case 17:return console.log("thread",r[1].data.children[0].data.body),console.log(e.data.title,"No match"),n.abrupt("return",null);case 20:case"end":return n.stop()}}),n)})))()}),[T]);return r.a.useEffect((function(){var e=!0;if(null!==D)return Object(E.a)(w.a.mark((function t(){var n,a,r;return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://www.reddit.com/r/scotch/search.json?q=title:review%20AND%20".concat(D,"&sort=new&restrict_sr=1&limit=100"));case 2:return n=t.sent,t.next=5,n.json();case 5:a=t.sent,r=[],console.log("Found n items",a.data.children.length,"for",D),0===a.data.children.length?e&&m([""]):(a.data.children.forEach((function(e){M(e)&&e.data.title.toLowerCase().includes(D.toLowerCase())&&r.push($(e,D))})),r.sort((function(e,t){return e.length-t.length})),e&&m(Array.from(new Set(r))));case 9:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[P,D]),r.a.useEffect((function(){o||m([])}),[o]),r.a.useEffect((function(){null!==j&&Object(E.a)(w.a.mark((function e(){var t,n,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.reddit.com/r/scotch/search.json?q=title:review%20AND%20".concat(j,"&sort=new&restrict_sr=1&limit=100"));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a=[],n.data.children.forEach((function(e){U(e)&&e.data.title.toLowerCase().includes(j.toLowerCase())?a.push(e):console.log("SKIP",e.data.title)})),console.log("# Fetch scores for",a.length,"items"),a.forEach((function(e){var t=e.data.name.split("t3_")[1];if("4pahzq"===t||"as7w3b"===t||"4w748u"===t||t.length>0){console.log(e.data.title),console.log(e.data.name,t),console.log("https://www.reddit.com".concat(e.data.permalink)),console.log(e.data);var n=G(e,t);console.log(n)}}));case 10:case"end":return e.stop()}}),e)})))()}),[j,G]),r.a.createElement(a.Fragment,null,r.a.createElement(O.a,{component:"main",maxWidth:"xs"},r.a.createElement(k.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(W.a,{component:"h1",variant:"h1"},r.a.createElement("span",{role:"img","aria-label":"Whisky glass image"},"\ud83e\udd43")),r.a.createElement("form",{className:e.form,noValidate:!0},r.a.createElement(q.a,{id:"asynchronous-demo",blurOnSelect:!0,open:o,onClose:function(){c(!1)},onInputChange:function(e,t,n){t.length>=5&&(f(t),"input"===n&&c(!0))},onChange:function(e,t){N(t),T(null)},getOptionSelected:function(e,t){return e===t},getOptionLabel:function(e){return e},options:s,loading:P,renderInput:function(e){return r.a.createElement(L.a,Object.assign({},e,{label:"Search for whisky reviews",variant:"outlined",InputProps:Object(u.a)({},e.InputProps,{endAdornment:r.a.createElement(r.a.Fragment,null,P?r.a.createElement(x.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))}}),r.a.createElement(y.a,{container:!0,style:{marginTop:25}},r.a.createElement(y.a,{item:!0,style:{width:"100%"}},null!==j&&A.length>0&&r.a.createElement(_,{maxWidth:400,height:80,points:A})),r.a.createElement(y.a,{item:!0,xs:!0},r.a.createElement(S.a,{href:"https://www.reddit.com/r/Scotch/",variant:"overline",display:"block",align:"center"},"/r/Skotch"," ",r.a.createElement("span",{role:"img","aria-label":"Whisky glass image"},"\u2764\ufe0f"))),r.a.createElement(y.a,{item:!0})))),r.a.createElement(C.a,{mt:8})))},K=function(){return r.a.createElement(p.a,null,r.a.createElement(f.c,null,r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement(f.a,{path:"/",component:G,exact:!0}),r.a.createElement(f.a,{path:"/about",component:g})))))};c.a.render(r.a.createElement(l.a,{store:h},r.a.createElement(K,null)),document.getElementById("root"))},93:function(e,t,n){e.exports=n(147)}},[[93,1,2]]]);
//# sourceMappingURL=main.6b91157a.chunk.js.map